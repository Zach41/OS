# Fork和Exec

一个shell做的事情就是用一个子进程来执行一个命令，要实现一个shell首先需要`fork`和`exec`来生成一个子进程。

一个进程的要素有：

1. 进程的代码、数据和堆栈
2. 占用proc_table一个表项
3. 在GDT中占用一个表项，用以存放进程对应的LDT表的描述符。

## Fork

Fork用来复制一个进程的内存数据、进程控制块、进程打开的文件描述符等信息给将要生成的子进程。

具体流程：
1. 分配一个proc_table表项并复制父进程的进程控制块信息。
2. 对子进程进程控制块进程对应设置(ldt选择子，pid等信息)
3. 分配一块内存给子进程，并复制父进程内存内容给子进程。
4. 更新子进程的ldt描述符
5. 共享父进程的文件

## Exec

exec的语义很简单，它将当前的进程映像换成另外一个。也就是说，我们从硬盘上读取一个可执行文件，用它替换掉刚刚fork出来的子进程，于是子进程就可以执行自己的任务了。

在执行exec时需要注意的是最站的传递，具体可以见代码和书本解释。


